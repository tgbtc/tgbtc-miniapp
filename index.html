<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>tgBTC Â· Testnet</title>

<style>
body{
  margin:0;
  background:#0b0f17;
  color:#e5e7eb;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
}
.wrap{max-width:820px;margin:auto;padding:14px}
.card{
  background:#0f172a;
  border:1px solid rgba(148,163,184,.18);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}
h1{font-size:18px;margin:0 0 6px}
h2{font-size:15px;margin:0 0 10px;color:#94a3b8}
.mono{font-family:ui-monospace,monospace}
table{width:100%;border-collapse:collapse}
td,th{padding:8px;border-bottom:1px solid rgba(148,163,184,.18);font-size:13px}
th{color:#94a3b8;text-align:left}
.right{text-align:right}
</style>
</head>

<body>
<div class="wrap">

  <h1>tgBTC Â· Testnet</h1>
<!-- TELEPORT INDICATOR -->
<div class="card" id="teleport">
  <h2>BTC â†’ tgBTC Teleport</h2>

  <div class="mono" id="teleportStatus">loadingâ€¦</div>
  <div class="mono muted" id="teleportTimer"></div>

  <div style="margin-top:10px;height:10px;border-radius:6px;
              background:rgba(148,163,184,.18);overflow:hidden">
    <div id="teleportBar"
         style="height:100%;width:0%;background:#22c55e"></div>
  </div>

  <div class="muted" style="margin-top:8px;font-size:12px">
    âš  Testnet only. Do not send real BTC.
  </div>
</div>

  <!-- SUPPLY -->
  <div class="card">
    <h2>Total Supply</h2>
    <div class="mono" id="supply">loadingâ€¦</div>
  </div>

  <!-- TX HISTORY -->
  <div class="card">
    <h2>Transaction history</h2>
    <table>
      <thead>
<tr>
  <th>Time</th>
  <th>Transaction</th>
</tr>
</thead>

      <tbody id="txs">
        <tr><td colspan="3">loadingâ€¦</td></tr>
      </tbody>
    </table>
  </div>

</div>

<script>
const DECIMALS = 8;

function fmt(raw){
  raw = String(raw || "0").padStart(DECIMALS+1,"0");
  return raw.slice(0,-DECIMALS) + "." + raw.slice(-DECIMALS);
}

// SUPPLY
fetch("/api/supply")
  .then(r=>r.json())
  .then(d=>{
    document.getElementById("supply").textContent =
      fmt(d.total_supply) + " tgBTC";
  });

// TRANSFERS
fetch("/api/transfers")
  .then(r=>r.json())
  .then(d=>{
    const tbody = document.getElementById("txs");
    tbody.innerHTML = "";
    d.forEach(t=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${new Date(t.utime*1000).toLocaleString()}</td>
        <td class="mono">
          <a target="_blank"
             href="https://testnet.tonviewer.com/transaction/${t.hash}">
            ${t.hash.slice(0,14)}â€¦
          </a>
        </td>
      `;
      tbody.appendChild(tr);
    });
  });


</script>
  <script>
<script>
const CYCLE = 60 * 60;         // 60:00
const OPEN_MIN = 30 * 60;      // remaining > 30:00
const OPEN_MAX = 50 * 60;      // remaining <= 50:00

function fmtMMSS(sec){
  const m = Math.floor(sec/60);
  const s = sec%60;
  return String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

async function teleportTick(){
  const status = document.getElementById("teleportStatus");
  const timer  = document.getElementById("teleportTimer");
  const bar    = document.getElementById("teleportBar");

  try{
    const r = await fetch("/api/teleport");
    const j = await r.json();
    if(!j.ok || !Number.isFinite(j.remaining_seconds)) throw new Error(j.error || "No timer");

    const rem = j.remaining_seconds;

    // Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ° Ñ†Ð¸ÐºÐ»Ð° Ð¿Ð¾ remaining (Ñ‡ÐµÐ¼ Ð¼ÐµÐ½ÑŒÑˆÐµ remaining, Ñ‚ÐµÐ¼ Ð´Ð°Ð»ÑŒÑˆÐµ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ)
    const progress = (1 - (rem / CYCLE)) * 100;
    bar.style.width = Math.max(0, Math.min(100, progress)).toFixed(2) + "%";

    const open = (rem > OPEN_MIN && rem <= OPEN_MAX);

    status.textContent = open ? "ðŸŸ¢ Mint window OPEN" : "ðŸ”´ Mint window CLOSED";
    bar.style.background = open ? "#22c55e" : "#ef4444";

    timer.textContent = `Address updates in: ${fmtMMSS(rem)} (cycle 60:00)`;
  } catch(e){
    status.textContent = "âš  Teleport timer unavailable";
    timer.textContent = "";
    bar.style.width = "0%";
    bar.style.background = "#ef4444";
  }
}

// Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‡Ð°ÑÑ‚Ð¾, Ð½Ð¾ Ð±ÐµÐ· Ñ„Ð°Ð½Ð°Ñ‚Ð¸Ð·Ð¼Ð°
setInterval(teleportTick, 5000);
teleportTick();
</script>

</script>

</body>
</html>




