<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>tgBTC · Testnet</title>

<style>
body{
  margin:0;
  background:#0b0f17;
  color:#e5e7eb;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
}
.wrap{max-width:820px;margin:auto;padding:14px}
.card{
  background:#0f172a;
  border:1px solid rgba(148,163,184,.18);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}
h1{font-size:18px;margin:0 0 6px}
h2{font-size:15px;margin:0 0 10px;color:#94a3b8}
.mono{font-family:ui-monospace,monospace}
table{width:100%;border-collapse:collapse}
td,th{padding:8px;border-bottom:1px solid rgba(148,163,184,.18);font-size:13px}
th{color:#94a3b8;text-align:left}
.right{text-align:right}
</style>
</head>

<body>
<div class="wrap">

  <h1>tgBTC · Testnet</h1>

  <!-- SUPPLY -->
  <div class="card">
    <h2>Total Supply</h2>
    <div class="mono" id="supply">loading…</div>
  </div>

  <!-- TX HISTORY -->
  <div class="card">
    <h2>Transaction history</h2>
    <table>
      <thead>
        <tr>
          <th>Time</th>
          <th>From → To</th>
          <th class="right">Amount</th>
        </tr>
      </thead>
      <tbody id="txs">
        <tr><td colspan="3">loading…</td></tr>
      </tbody>
    </table>
  </div>

</div>

<script>
const DECIMALS = 8;

function fmt(raw){
  raw = String(raw || "0").padStart(DECIMALS+1,"0");
  return raw.slice(0,-DECIMALS) + "." + raw.slice(-DECIMALS);
}

// SUPPLY
fetch("/api/supply")
  .then(r=>r.json())
  .then(d=>{
    document.getElementById("supply").textContent =
      fmt(d.total_supply) + " tgBTC";
  });

// TRANSFERS
fetch("/api/transfers")
  .then(r=>r.json())
  .then(d=>{
    const tbody = document.getElementById("txs");
    tbody.innerHTML = "";
    if(!d.length){
      tbody.innerHTML = `<tr><td colspan="3">No transactions yet</td></tr>`;
      return;
    }
    d.forEach(t=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${new Date(t.utime*1000).toLocaleString()}</td>
        <td colspan="2" class="mono">
          <a target="_blank"
             href="https://testnet.tonviewer.com/transaction/${t.hash}">
            ${t.hash.slice(0,12)}…
          </a>
        </td>
      `;
      tbody.appendChild(tr);
    });
  });

</script>
</body>
</html>

